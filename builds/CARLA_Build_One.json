{
  "name": "CARLA_Build_One",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "carla-create-booking",
        "authentication": "headerAuth",
        "headerAuth": "Header Auth account 2",
        "responseMode": "onLastNode",
        "options": {},
        "responseCode": 200,
        "responseData": "firstEntryJson"
      },
      "id": "Webhook_Create",
      "name": "Webhook: Create Booking",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [200, 0]
    },
    {
      "parameters": {
        "functionCode": "const auth = $json.headers['authorization'];\nif (auth !== 'Bearer yeehaw') {\n  throw new Error('Unauthorized: Missing or incorrect token');\n}\nreturn items;"
      },
      "id": "Header_Validation",
      "name": "Verify Header Token",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [400, 0]
    },
    {
      "parameters": {
        "functionCode": "// TODO: Translate Checkfront booking into internal Google Calendar event\nreturn items;"
      },
      "id": "Process_Create",
      "name": "Process Booking (Create)",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [600, 0]
    },

    {
      "parameters": {
        "httpMethod": "POST",
        "path": "carla-update-calendar",
        "authentication": "headerAuth",
        "headerAuth": "Header Auth account 2",
        "responseMode": "onLastNode",
        "options": {},
        "responseCode": 200,
        "responseData": "firstEntryJson"
      },
      "id": "Webhook_Update",
      "name": "Webhook: Update Calendar",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [200, 250]
    },
    {
      "parameters": {
        "functionCode": "const auth = $json.headers['authorization'];\nif (auth !== 'Bearer yeehaw') {\n  throw new Error('Unauthorized: Missing or incorrect token');\n}\nreturn items;"
      },
      "id": "Header_Validation_Update",
      "name": "Verify Header Token (Update)",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [400, 250]
    },
    {
      "parameters": {
        "functionCode": "// TODO: Handle Checkfront booking status updates, modify calendar accordingly\nreturn items;"
      },
      "id": "Process_Update",
      "name": "Process Booking (Update)",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [600, 250]
    }
  ],
  "connections": {
    "Webhook: Create Booking": {
      "main": [[{"node": "Verify Header Token", "type": "main", "index": 0}]]
    },
    "Verify Header Token": {
      "main": [[{"node": "Process Booking (Create)", "type": "main", "index": 0}]]
    },

    "Webhook: Update Calendar": {
      "main": [[{"node": "Verify Header Token (Update)", "type": "main", "index": 0}]]
    },
    "Verify Header Token (Update)": {
      "main": [[{"node": "Process Booking (Update)", "type": "main", "index": 0}]]
    }
  },
  "active": false,
  "settings": {},
  "tags": [
    {
      "name": "CARLA"
    }
  ]
}
